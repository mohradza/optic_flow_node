<launch>
<!-- Simple launch file to run offline optic flow on recorderd usb cam images-->
  <arg name="oflow_plot" default="false" doc="plot tangential optic flow (not filtered) vs gamma along time"/>


  <node pkg="nodelet" type="nodelet" name="standalone_nodelet" args="manager" output="screen" />

    <!-- Downsample RGB Image -->
    <node pkg="nodelet" type="nodelet" name="rgb_resize" args="load image_proc/resize standalone_nodelet" respawn="true" >
        <remap from="image" to="/videofile/image_raw"/>
        <remap from="~image" to="/videofile/image_small"/>
        <rosparam>
            use_scale: True
            scale_height: 0.125
            scale_width: 0.125
        </rosparam>
    </node>

  <node name="rgb_optic_flow_node" pkg="optic_flow_node" type="optic_flow_node" output="screen" >
      <remap from="/usb_cam/image_raw" to="/videofile/image_small"/>
      <param name="image_center_x" value="320"/>
      <param name="image_center_y" value="240"/>
      <param name="inner_ring_radius" value="220"/>
      <param name="ring_dr" value="10"/>
      <param name="num_ring_points" value="160"/>
      <param name="num_rings" value="5"/>
      <param name="pixel_scale" value="215"/>
      <param name="alpha" value="0.7"/>

      <param name="num_ring_points" value="100"/>
      <param name="num_rings" value="100"/>

      <param name="num_of_rows" value="23"/>
      <param name="num_of_cols" value="23"/>

      <param name="pyr_window_size" value="20"/>
      <param name="num_of_pyramids" value="3"/>

      <param name="if_blur" value="false"/>
      <!-- Blur size must be an int odd number -->
      <param name="blur_size" value="21"/>

  </node>

    <!-- Downsample RGB Image -->
    <node pkg="nodelet" type="nodelet" name="thermal_resize" args="load image_proc/resize standalone_nodelet" respawn="true" >
        <remap from="image" to="/lepton_viz"/>
        <remap from="~image" to="/lepton_viz_small"/>
        <rosparam>
            use_scale: True
            scale_height: 0.250
            scale_width: 0.250
        </rosparam>
    </node>

  <node name="thermal_optic_flow_node" pkg="optic_flow_node" type="optic_flow_node" output="screen" >
      <remap from="/usb_cam/image_raw" to="/lepton_viz_small"/>
      <param name="image_center_x" value="320"/>
      <param name="image_center_y" value="240"/>
      <param name="inner_ring_radius" value="220"/>
      <param name="ring_dr" value="10"/>
      <param name="num_ring_points" value="160"/>
      <param name="num_rings" value="5"/>
      <param name="pyr_window_size" value="41"/>
      <param name="pixel_scale" value="215"/>
      <param name="alpha" value="0.7"/>

      <param name="num_ring_points" value="100"/>
      <param name="num_rings" value="100"/>

      <param name="num_of_rows" value="23"/>
      <param name="num_of_cols" value="23"/>

      <param name="pyr_window_size" value="41"/>
      <param name="num_of_pyramids" value="7"/>

      <param name="if_blur" value="true"/>
      <!-- Blur size must be an int odd number -->
      <param name="blur_size" value="41"/>

  </node>

</launch>
